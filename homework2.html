<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>MSAN 622 Homework2</title>

<link href="css/bootstrap.min.css" rel="stylesheet">
<link href="css/bootstrap-theme.min.css" rel="stylesheet">

<style type="text/css">
    body {
        padding-top: 50px;
        padding-bottom: 20px;
    }
</style>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/d3.min.js"></script>
</head>


<body>
<!-- Fixed Navbar -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle Navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/index.html">MSAN 622</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li><a href="#homework">Homework</a></li>
                <li><a href="#project">Project</a></li>
                <li><a href="#participation">Participation</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<div class = "container">
		<h2>Homework2</h2>
		<ul>
            <li><h4>Bubble Chart</h4></li>
        </ul>
        <div id="chart" width="1000" height="640">
            <script>
// ploting variable
var margin = {"left":80,"top":40,"right":30,"bottom":30};
var width = 800;
var height = 500;
var frameWidth = width + margin.left + margin.right;
var frameHeight = height + margin.top + margin.bottom;
//data

//console.log("after data");
//console.log(data);
//plot element
var radius = 20;
var svg1 = d3.select("#chart").append("svg").attr("width", frameWidth).attr("height",frameHeight).attr('class','frame'); //create frame
//var plot1 = svg1.append("svg").attr('width',width).attr('height',height).attr("transform", "translate(" + margin.left + "," + margin.top + ")").attr('class','plot');



var xScale = d3.scale.linear().range([0,width]);
var yScale = d3.scale.linear().range([height,0]);
var rScale = d3.scale.linear().range([0,radius]);

var xAxis = d3.svg.axis().scale(xScale).orient("bottom");
var yAxis = d3.svg.axis().scale(yScale).orient("left");


//console.log("fefef"data);
d3.csv("homework2/stateX77.csv",function(d){
    return {
        'stateName' : d.stateName,
        'stateAbb' : d.stateAbb,
        'population' : +d.population,
        'Income' : +d.Income,
        'illiteracy' : +d.illiteracy,
        'lifeExp' : +d.lifeExp,
        'murder' : +d.murder,
        'hsGrad' : +d.hsGrad,
        'frost' : +d.frost,
        'area' : +d.area,
        'stateRegion' : d.stateRegion,
        'stateDivision' : d.stateDivision };

        },function(error, rows){
          // code to generate chart goes here

            console.log( rows );

    var min1 = d3.min(rows, function(d){ return d.hsGrad;});
    var max1 = d3.max(rows, function(d){ return d.hsGrad;});

    console.log(min1);
    var min2 = d3.min(rows, function(d){ return d.lifeExp;});
    var max2 = d3.max(rows, function(d){ return d.lifeExp;});

    var percent = 0.06;
    xScale.domain([ min1 - percent * (max1 - min1), max1 + percent * (max1 - min1)]);
    yScale.domain([ min2 - percent * (max2 - min2) , max2 + percent * (max2 - min2)]);

    rScale.domain([d3.min(rows, function(d){return Math.sqrt(d.Income);}),d3.max(rows, function(d){return Math.sqrt(d.Income);})]);
    var circles = svg1.selectAll("circle").data(rows).enter().append("circle")
        .attr("cx", function(d){return xScale(d.hsGrad);})
        .attr("cy", function(d){return height - yScale(d.lifeExp);})
        .attr("r",  function(d){return rScale(Math.sqrt(d.Income));})
        .attr("transform", "translate(" + margin.left + ",0)")
        .style('fill','blue').style("fill-opacity",0.4)
        .on("mouseover", function (d) {

                d3.select(this).style('fill', "#FD8D3C").style('fill-opacity',0.9);

                var xPosition = parseFloat(d3.select(this).attr("cx")) + margin.left ;
                var yPosition = parseFloat(d3.select(this).attr("cy")) - 10;

                d3.select('.frame').append("text").attr("transform","translate(" + margin.left + ",0)")
                        .attr("id", "tooltip")
                        .attr("x", xPosition)
                        .attr("y", yPosition)
                        .attr("text-anchor", "middle")
                        .attr("font-family", "sans-serif")
                        .attr("font-size", "14px")
                        .attr("font-weight", "bold")
                        .attr("fill", "black")
                        .text(d.stateAbb + ",( " +d.hsGrad + " , " + d.lifeExp + " )"); })
            .on("mouseout", function(d){

                d3.select(this).style("fill","blue").style("fill-opacity",0.4);
                d3.select("#tooltip").remove(); // end of style
            });


    var xGuide = svg1.append("g").attr("class", "Axis").attr("id","xAxis").attr("transform", "translate(" + margin.left + "," + height + ")").call(xAxis);
    var yGuide = svg1.append("g").attr("class", "Axis").attr("id","yAxis").attr("transform", "translate(" + margin.left + ",0)").call(yAxis);

    yGuide.append("text")
            .attr("transform", "rotate(-90)")
            .attr("y", -70).attr("x",-height/2 + 80)
            .attr("dy", ".71em")
            .style("text-anchor", "end")
            .text("Life Expectency (year)");

    xGuide.append("text").attr("x", width/2 + 130).attr("y", 50)
            .style("text-anchor", "end")
            .text("High School Graduates \n(percentage)");


    xGuide.selectAll('line').style('fill',"none").style("stroke","black");
    xGuide.selectAll('path').style('fill',"none").style("stroke","black");
    yGuide.selectAll('line').style("fill","none").style("stroke","black");
    yGuide.selectAll('path').style("fill","none").style("stroke","black");


});
            </script>
        </div>
        <ul>
            <li><h4>Heatmap</h4></li>
        </ul>
        <div id="chart1" width="1200" height="640">
            <script>


var margin2 = {"left":150,"top":40,"right":120,"bottom":30};
var frameWidth2 = width + margin2.left + margin2.right;
var frameHeight2 = height + margin2.top + margin2.bottom;

var svg2 = d3.select("#chart1").append("svg").attr("width", frameWidth2).attr("height",frameHeight2).attr('class','frame'); //create frame

var xScale2 = d3.scale.ordinal().rangeBands([0,width],0,0);
var yScale2 = d3.scale.ordinal().rangeBands([height,0],0,0);
var zScale2 = d3.scale.linear().range(["white","steelblue"]);

var xAxis2 = d3.svg.axis().scale(xScale2).orient("bottom");
var yAxis2 = d3.svg.axis().scale(yScale2).orient("left");




d3.csv("homework2/stateX77aggregate.csv",function(d){
    return {

        'stateRegion' : d.stateRegion,
        'illiteracyRange': d.illiteracyRange,
        'count' : d.x};

        },function(error, rows) {
    // code to generate chart goes here

    xScale2.domain(rows.map(function(d){ return d.illiteracyRange ; }));
    yScale2.domain(rows.map(function(d){ return d.stateRegion ; }));
//    zScale2.domain( d3.extent(function(d){ return d.count; }));
    zScale2.domain( [0, d3.max(rows, function(d){ return d.count; })]);

    var xGuide2 = svg2.append('g').attr("class","xAxis2").attr("transform","translate(" + margin2.left + "," + height + ")").call(xAxis2);
    var yGuide2 = svg2.append('g').attr("class","yAxis2").attr("transform","translate(" + margin2.left + ",0)").call(yAxis2);

    xGuide2.selectAll("line").style("fill","none");
    xGuide2.select("path").style("fill","none").style("stroke","black");
    yGuide2.selectAll("line").style("fill","none");
    yGuide2.select("path").style("fill","none").style("stroke","black");
    console.log(rows);


    svg2.selectAll(".tile").data(rows).enter().append("rect").attr("class","tile").attr("transform","translate("+ margin2.left + ",0)")
            .attr("x", function(d){return xScale2(d.illiteracyRange);})
            .attr("y", function(d){ return yScale2(d.stateRegion);})
            .style("fill", function(d){ return zScale2(d.count);})
            .attr("width", xScale2.rangeBand())
            .attr("height", yScale2.rangeBand());


    var temp = rows.map(function(d){ return d.count});
    var oTemp = {};
    for ( var i = 0; i < temp.length ; i++ ){ oTemp[temp[i]] = 0;}
    console.log(Object.keys(oTemp));

    var legend = svg2.selectAll(".legend")
      .data(Object.keys(oTemp).reverse())
    .enter().append("g")
      .attr("class", "legend")
      .attr("transform", function(d, i) { return "translate(" + (width + margin.left + 120) + "," + ( margin.top + 50 + i * 20) + ")"; });

    legend.append("rect")
      .attr("width", 20)
      .attr("height", 20)
      .style("fill", zScale2);

    legend.append("text")
      .attr("x", 26)
      .attr("y", 10)
      .attr("dy", ".35em")
      .text(String);

    svg2.append("text")
            .attr("transform", "translate(" + (width + margin.left + 120) + "," + ( margin.top + 50) + ")")
            .attr("x",-20)
            .attr("y",-10)
            .text("State Count");

});

            </script>
        </div>
</div>


</body>
</html>